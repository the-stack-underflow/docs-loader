<!doctype html><html lang=en><!-- Online page at https://ziglang.org/documentation/0.10.0/std/#root;os.linux.BPF.MapType --><head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <title>MapType</title> <link href=../../../../style.css rel=stylesheet></head> <body class=canvas> <div class=banner> This is a beta autodoc build; expect bugs and missing information.</div> <div class=flex-main> <div id=docs class=flex-right> <div class=wrap> <section class=docs> <div style=position:relative> </div> <div id=sectNav class=""><ul id=listNav><li><a href=../../../../std.html class="">std</a></li><li><a href=../../../../std/os.html class="">os</a></li><li><a href=../../../../std/os/linux.html class="">linux</a></li><li><a href=../../../../std/os/linux/BPF.html class="">BPF</a></li><li><a href=MapType.html class=active>MapType</a></li></ul></div> <div id=sectFields class=""> <a name=//apple_ref/cpp/Section/Fields class=dashAnchor></a><h2>Fields</h2> <div id=listFields><div><div class=mobile-scroll-container><pre class=scroll-item>unspec = <span class=tok-number>unspec</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>hash = <span class=tok-number>hash</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>array = <span class=tok-number>array</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>prog_array = <span class=tok-number>prog_array</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>perf_event_array = <span class=tok-number>perf_event_array</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>percpu_hash = <span class=tok-number>percpu_hash</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>percpu_array = <span class=tok-number>percpu_array</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>stack_trace = <span class=tok-number>stack_trace</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>cgroup_array = <span class=tok-number>cgroup_array</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>lru_hash = <span class=tok-number>lru_hash</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>lru_percpu_hash = <span class=tok-number>lru_percpu_hash</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>lpm_trie = <span class=tok-number>lpm_trie</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>array_of_maps = <span class=tok-number>array_of_maps</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>hash_of_maps = <span class=tok-number>hash_of_maps</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>devmap = <span class=tok-number>devmap</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>sockmap = <span class=tok-number>sockmap</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>cpumap = <span class=tok-number>cpumap</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>xskmap = <span class=tok-number>xskmap</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>sockhash = <span class=tok-number>sockhash</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>cgroup_storage = <span class=tok-number>cgroup_storage</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>reuseport_sockarray = <span class=tok-number>reuseport_sockarray</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>percpu_cgroup_storage = <span class=tok-number>percpu_cgroup_storage</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>queue = <span class=tok-number>queue</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>stack = <span class=tok-number>stack</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>sk_storage = <span class=tok-number>sk_storage</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>devmap_hash = <span class=tok-number>devmap_hash</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class=scroll-item>struct_ops = <span class=tok-number>struct_ops</span>,</pre></div></div><div><div class=mobile-scroll-container><pre class="scroll-item fieldHasDocs">ringbuf = <span class=tok-number>ringbuf</span>,</pre></div><div class=fieldDocs><p> An ordered and shared CPU version of perf_event_array. They have similar semantics: </p> <ul> <li> variable length records</li> <li> no blocking: when full, reservation fails</li> <li> memory mappable for ease and speed</li> <li> epoll notifications for new data, but can busy poll</li> </ul> <p> Ringbufs give BPF programs two sets of APIs: </p> <ul> <li> ringbuf_output() allows copy data from one place to a ring</li> </ul> <p> buffer, similar to bpf_perf_event_output() </p> <ul> <li> ringbuf_reserve()/ringbuf_commit()/ringbuf_discard() split the</li> </ul> <p> process into two steps. First a fixed amount of space is reserved, if that is successful then the program gets a pointer to a chunk of memory and can be submitted with commit() or discarded with discard() </p> <p> ringbuf_output() will incurr an extra memory copy, but allows to submit records of the length that's not known beforehand, and is an easy replacement for perf_event_outptu(). </p> <p> ringbuf_reserve() avoids the extra memory copy but requires a known size of memory beforehand. </p> <p> ringbuf_query() allows to query properties of the map, 4 are currently supported: </p> <ul> <li> BPF_RB_AVAIL_DATA: amount of unconsumed data in ringbuf</li> <li> BPF_RB_RING_SIZE: returns size of ringbuf</li> <li> BPF_RB_CONS_POS/BPF_RB_PROD_POS returns current logical position</li> </ul> <p> of consumer and producer respectively </p> <p> key size: 0 value size: 0 max entries: size of ringbuf, must be power of 2 </p> </div></div></div> </div> </section> </div> <div class=flex-filler></div> </div> </div> </body></html>